# Story 8.1: Set up GitHub Actions CI Pipeline for Backend Services

## Status: Draft

## Story
**As a** developer,  
**I want** automated CI for backend services,  
**so that** code quality is verified on every push.

## Acceptance Criteria
1. GitHub Actions workflow `.github/workflows/ci-backend.yml` created
2. Runs on push to main, develop, and pull requests
3. Steps: checkout, setup Java 21, cache Maven, run tests, upload reports
4. Tests run in parallel for all 8 microservices (matrix strategy)
5. Fail if tests fail or coverage <80%
6. Status badge added to README

## Tasks / Subtasks
- [ ] Task 1: Create workflow file (AC: 1)
  - [ ] Create `.github/workflows/ci-backend.yml`
  - [ ] Define workflow name and description

- [ ] Task 2: Configure triggers (AC: 2)
  - [ ] Push to main branch
  - [ ] Push to develop branch
  - [ ] Pull request events

- [ ] Task 3: Define job steps (AC: 3)
  - [ ] Checkout code
  - [ ] Setup Java 21
  - [ ] Cache Maven dependencies
  - [ ] Run `mvn clean verify`
  - [ ] Upload test reports

- [ ] Task 4: Configure matrix (AC: 4)
  - [ ] Define service matrix
  - [ ] Run parallel jobs

- [ ] Task 5: Add quality gates (AC: 5)
  - [ ] Check test pass/fail
  - [ ] Check coverage threshold
  - [ ] Fail workflow on violations

- [ ] Task 6: Add status badge (AC: 6)
  - [ ] Generate badge URL
  - [ ] Add to README.md

## Dev Notes

### Workflow Configuration
```yaml
name: Backend CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        service: [api-gateway, ingredient-matching, recipe-search, ...]
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'temurin'
      - uses: actions/cache@v4
        with:
          path: ~/.m2
          key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
      - run: mvn -f services/${{ matrix.service }}/pom.xml clean verify
```

## Testing

### Test Cases
1. Workflow triggers on push
2. All services tested in parallel
3. Failed tests fail workflow
4. Coverage below 80% fails workflow

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-20 | 1.0 | Initial story creation | Bob (SM) |
