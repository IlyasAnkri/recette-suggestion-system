# Story 8.6: Set up Staging Environment and Deployment Workflow

## Status: Draft

## Story
**As a** developer,  
**I want** a staging environment for pre-production testing,  
**so that** changes can be validated before production.

## Acceptance Criteria
1. Staging environment on Render.com (separate services)
2. Staging site on Netlify (staging.recipe-adjuster.com)
3. Workflow `.github/workflows/deploy-staging.yml` created
4. Triggers on push to develop branch
5. E2E tests run against staging
6. Manual approval required before promoting to production

## Tasks / Subtasks
- [ ] Task 1: Create Render staging (AC: 1)
  - [ ] Create staging services
  - [ ] Configure staging env vars

- [ ] Task 2: Create Netlify staging (AC: 2)
  - [ ] Create staging site
  - [ ] Configure subdomain

- [ ] Task 3: Create workflow (AC: 3)
  - [ ] Create deploy-staging.yml

- [ ] Task 4: Configure triggers (AC: 4)
  - [ ] On push to develop

- [ ] Task 5: Run E2E tests (AC: 5)
  - [ ] Install Playwright
  - [ ] Run tests against staging

- [ ] Task 6: Manual approval (AC: 6)
  - [ ] Add environment protection rule
  - [ ] Require review for production

## Dev Notes

### Staging URLs
- API: https://staging-api.recipe-adjuster.com
- Web: https://staging.recipe-adjuster.com

## Testing

### Test Cases
1. Staging deploys on develop push
2. E2E tests run against staging
3. Production requires approval
4. Staging isolated from production

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-20 | 1.0 | Initial story creation | Bob (SM) |
