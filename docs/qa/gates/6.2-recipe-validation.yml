schema: 1
story: "6.2"
story_title: "Story 6.2: Implement Recipe Validation and Duplicate Detection"
gate: "CONCERNS"
status_reason: "Core validation is comprehensive and well-tested, but ingredient ID verification is not backed by a real ingredient store and duplicate detection does not return HTTP 409 as required."
reviewer: "Quinn (Test Architect)"
updated: "2025-12-21T17:46:00Z"
waiver: { active: false }
top_issues:
  - id: "VAL-001"
    severity: high
    finding: "Ingredient IDs are not actually verified against an authoritative ingredient collection/service."
    suggested_action: "Integrate a real ingredient lookup (repository or external service) and fail when unknown IDs are supplied."
  - id: "VAL-002"
    severity: medium
    finding: "Duplicate recipes are treated as generic validation errors (400) instead of returning HTTP 409 as per AC."
    suggested_action: "Map duplicate-detected cases to a dedicated error path that returns 409 with clear duplicate details."
risk_summary:
  totals: { critical: 0, high: 1, medium: 1, low: 0 }
  recommendations:
    must_fix:
      - "Back ingredient ID checks with a real data source and add tests for invalid IDs."
      - "Return HTTP 409 for duplicate recipes and cover with controller/integration tests."
    monitor:
      - "Monitor validation performance if duplicate detection runs over large recipe sets."
recommendations:
  immediate:
    - "Implement real ingredient ID verification and 409 semantics before exposing this endpoint externally."
  future:
    - "Consider caching popular ingredient lookups to keep validation latency low."
