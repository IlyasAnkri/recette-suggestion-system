schema: 1
story: "6.6"
story_title: "Story 6.6: Implement Recipe Search Indexing and Kafka Events"
gate: "CONCERNS"
status_reason: "Kafka publishing on recipe approval/update is implemented, but the search consumer is missing, event metadata is incomplete, and correlation IDs are not propagated from incoming requests."
reviewer: "Quinn (Test Architect)"
updated: "2025-12-21T17:46:00Z"
waiver: { active: false }
top_issues:
  - id: "EVT-001"
    severity: high
    finding: "Recipe Search Service consumer for recipe events (AC4) is not implemented."
    suggested_action: "Implement a consumer in recipe-search-service that updates the search index on recipe.created/recipe.updated events."
  - id: "EVT-002"
    severity: high
    finding: "Event payload does not include all metadata from AC (e.g., cuisine, difficulty)."
    suggested_action: "Extend RecipeEvent and publishing logic to include cuisine and difficulty fields."
  - id: "EVT-003"
    severity: medium
    finding: "Correlation IDs are generated randomly instead of being propagated from the incoming request or trace context."
    suggested_action: "Propagate correlation/trace IDs from HTTP headers or existing context into Kafka events."
risk_summary:
  totals: { critical: 0, high: 2, medium: 1, low: 0 }
  recommendations:
    must_fix:
      - "Deliver the search-service consumer and end-to-end tests before declaring indexing fully done."
      - "Align event schema with AC and document it as a formal contract."
    monitor:
      - "Monitor Kafka publishing/consumption metrics and dead-letter behavior once the pipeline is live."
recommendations:
  immediate:
    - "Add contract tests around RecipeEvent JSON to prevent schema drift."
  future:
    - "Introduce tracing integration so correlation IDs tie HTTP requests to Kafka events and downstream processing."
